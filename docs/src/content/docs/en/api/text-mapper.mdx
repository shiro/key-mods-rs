---
title: 'Text mapper'
description: 'Text mapper | map2 API documentation'
---


Creates a text-based mapping layer that triggers on certain key-sequences (hotstrings).
When activated, it erases the trigger sequence by emmiting `backspace` key events and
then emmits the replacement text or calls a user-function.

```python
import map2

# set the output keyboard layout
map2.default(layout = "us")

reader = map2.Reader(patterns=[ "/dev/input/by-id/example"])
mapper = map2.TextMapper()
writer = map2.Writer(clone_from = "/dev/input/by-id/example")

map2.link([reader, mapper, writer])

# map text to other text
mapper.map("hello", "bye")

# capitals and special letters are allowed
mapper.map("LaSeRs", "lAsErS!")

# map to user-function
def greet():
    print("Hello!")
mapper.map("greet", greet)

# ❌ This won't work, writers can only output keys contained
# in the output keybarod layout.
# Since we specified the 'us' layout above, we can't map to kanji directly.
mapper.map("usagi", "兎")

# ✅ we can instead use a virtual writer for outputing special characters.
# note: not all environments support virtual writers
virtual_writer = map2.VirtualWriter()
def write_special(text):
    def fn(): writer_virtual.send(text)
    return fn
mapper.map("usagi", write_special("兎"))
```



Supported on:
- ✅ Hyprland
- ✅ X11
- ✅ Gnome (wayland)
- ✅ KDE plasma (wayland)

## Options


### model

```
string?
```

Sets the XKB keyboard model.

### layout

```
string?
```

Sets the XKB keyboard layout.

### variant

```
string?
```

Sets the XKB keyboard variant.

### options

```
string?
```

Sets the XKB keyboard options.




## Methods

### map(key, key_sequence)

Maps a key to a key sequence.

- **key**: key
- **key_sequence**: key_sequence

### map_key(key_from, key_to)

Maps a key to a key.

- **key_from**: key
- **key_to**: key

### map_fallback(handler)

Maps all keys without explicit mappings to a user function

- **handler**: (key: key, state: "down" | "up" | "repeat") -> string?

### map_relative(handler)

Maps relative movement input events such as mouse moves to a user function.

- **handler**: (type: string, value: int) -> string?

### map_absolute(handler)

Maps absolute movement input events such as touchscreen taps to a user function.

- **handler**: (type: string, value: int) -> string?
